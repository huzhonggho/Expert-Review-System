import{b as V}from"./cadres-c7405279.js";import{b as q}from"./review-46614018.js";import{d as F,r as f,u as E,g as j,m as L,a as r,o as z,c as M,b as k,e,w as l,f as _,h as I,x as A,y as D,_ as G}from"./index-ddeb11e4.js";const H={class:"cadres-add-container"},J={class:"form"},K={class:"btns"},Q=F({__name:"add",setup(S){const g=f(null),y=E(),b=f(!1),t=f({cadresNumber:"",cadresName:"",dept:"",position:"",orders:1,reviewId:"",gender:null,birth:null,nation:null,party:null,joinTime:null,title:"",dutyTime:null,getTime:null,publishTime:null,teachingTitle:"",duties:"",education:"",degree:"",graduation:"",major:"",graduateTime:null,nativePlace:"",introduction:"",description:"",memo:""});let c=null;const v=f(""),m=j([]),T=j([]),h=f(!1);L(v,()=>{c!=null&&(clearTimeout(c),c=null),c=setTimeout(async()=>{h.value=!0;const{data:i}=await q(v.value);if(h.value=!1,T.splice(0),m.splice(0),i.list.length==0){y.error("无相关评审");return}i.list.forEach(a=>{let s={id:a.reviewId,reviewName:a.reviewName};T.push(s),m.push(a.reviewName)})},1e3)});const C={cadresNumber:{required:!0,message:"请输入干部工号",trigger:"blur"},cadresName:{required:!0,message:"请输入干部姓名",trigger:"blur"},reviewName:{validator:()=>!!m.includes(v.value),message:"请正确输入所属评审项目名",trigger:"blur"}},w=()=>{var i;t.value={cadresNumber:"",cadresName:"",dept:"",position:"",orders:1,reviewId:"",gender:null,birth:null,nation:null,party:null,joinTime:null,title:"",dutyTime:null,getTime:null,publishTime:null,teachingTitle:"",duties:"",education:"",degree:"",graduation:"",major:"",graduateTime:null,nativePlace:"",introduction:"",description:"",memo:""},v.value="",(i=g.value)==null||i.restoreValidation()},O=()=>{var i;(i=g.value)==null||i.validate(async a=>{if(a)y.error("请将表单填写完整");else{let s={...t.value};s.reviewId=T[m.indexOf(v.value)].id;let o;b.value=!0;try{o=await V(s)}catch{b.value=!1;return}b.value=!1,y.success(o.message),w()}})};return(i,a)=>{const s=r("n-divider"),o=r("n-input"),d=r("n-form-item"),n=r("n-gi"),P=r("n-input-number"),R=r("n-auto-complete"),N=r("n-grid"),U=r("n-select"),p=r("n-date-picker"),x=r("n-button"),B=r("n-form");return z(),M("div",H,[k("div",J,[e(B,{ref_key:"formRef",ref:g,model:t.value,rules:C,size:"medium","label-placement":"left","label-width":100,"label-align":"left","show-require-mark":!1},{default:l(()=>[e(s,{"title-placement":"left"},{default:l(()=>[_("必填项")]),_:1}),e(N,{"x-gap":"100",cols:3,"layout-shift-disabled":""},{default:l(()=>[e(n,null,{default:l(()=>[e(d,{label:"干部工号",path:"cadresNumber"},{default:l(()=>[e(o,{value:t.value.cadresNumber,"onUpdate:value":a[0]||(a[0]=u=>t.value.cadresNumber=u),placeholder:"输入干部工号",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"姓名",path:"cadresName"},{default:l(()=>[e(o,{value:t.value.cadresName,"onUpdate:value":a[1]||(a[1]=u=>t.value.cadresName=u),placeholder:"输入干部姓名",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"序号",path:"orders"},{default:l(()=>[e(P,{value:t.value.orders,"onUpdate:value":a[2]||(a[2]=u=>t.value.orders=u),min:1},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"所属评审项目",path:"reviewName"},{default:l(()=>[e(R,{value:v.value,"onUpdate:value":a[3]||(a[3]=u=>v.value=u),"input-props":{autocomplete:"disabled"},options:m,placeholder:"请输入评审项目名",loading:h.value,clearable:""},null,8,["value","options","loading"])]),_:1})]),_:1}),e(n)]),_:1}),e(s,{"title-placement":"left"},{default:l(()=>[_("选填项")]),_:1}),e(N,{"x-gap":"100",cols:3,"layout-shift-disabled":""},{default:l(()=>[e(n,null,{default:l(()=>[e(d,{label:"部门",path:"dept"},{default:l(()=>[e(o,{value:t.value.dept,"onUpdate:value":a[4]||(a[4]=u=>t.value.dept=u),placeholder:"输入部门",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"职称",path:"position"},{default:l(()=>[e(o,{value:t.value.position,"onUpdate:value":a[5]||(a[5]=u=>t.value.position=u),placeholder:"输入职称",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"性别",path:"gender"},{default:l(()=>[e(U,{value:t.value.gender,"onUpdate:value":a[6]||(a[6]=u=>t.value.gender=u),placeholder:"请选择性别",clearable:"",options:[{label:"男",value:"男"},{label:"女",value:"女"}]},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"出生年月",path:"birth"},{default:l(()=>[e(p,{value:t.value.birth,"onUpdate:value":a[7]||(a[7]=u=>t.value.birth=u),placeholder:"请选择出生年月",clearable:"",type:"date"},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"籍贯",path:"nativePlace"},{default:l(()=>[e(o,{value:t.value.nativePlace,"onUpdate:value":a[8]||(a[8]=u=>t.value.nativePlace=u),placeholder:"输入籍贯",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"民族",path:"nation"},{default:l(()=>[e(U,{value:t.value.nation,"onUpdate:value":a[9]||(a[9]=u=>t.value.nation=u),placeholder:"请选择民族",clearable:"",options:I(A)},null,8,["value","options"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"党派",path:"party"},{default:l(()=>[e(U,{value:t.value.party,"onUpdate:value":a[10]||(a[10]=u=>t.value.party=u),placeholder:"请选择党派",clearable:"",options:I(D)},null,8,["value","options"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"职务",path:"duties"},{default:l(()=>[e(o,{value:t.value.duties,"onUpdate:value":a[11]||(a[11]=u=>t.value.duties=u),placeholder:"输入职务",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"职称级别",path:"title"},{default:l(()=>[e(o,{value:t.value.title,"onUpdate:value":a[12]||(a[12]=u=>t.value.title=u),placeholder:"请输入职称级别",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"教学职称",path:"teachingTitle"},{default:l(()=>[e(o,{value:t.value.teachingTitle,"onUpdate:value":a[13]||(a[13]=u=>t.value.teachingTitle=u),placeholder:"输入教学职称",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"来院工作时间",path:"joinTime"},{default:l(()=>[e(p,{value:t.value.joinTime,"onUpdate:value":a[14]||(a[14]=u=>t.value.joinTime=u),placeholder:"请选择来院工作时间",clearable:"",type:"datetime"},null,8,["value"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"任职时间",path:"dutyTime"},{default:l(()=>[e(p,{value:t.value.dutyTime,"onUpdate:value":a[15]||(a[15]=u=>t.value.dutyTime=u),placeholder:"请选择任职时间",clearable:"",type:"datetime"},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"取得资格时间",path:"getTime"},{default:l(()=>[e(p,{value:t.value.getTime,"onUpdate:value":a[16]||(a[16]=u=>t.value.getTime=u),placeholder:"请选择取得资格时间",clearable:"",type:"datetime"},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"公示时间",path:"publishTime"},{default:l(()=>[e(p,{value:t.value.publishTime,"onUpdate:value":a[17]||(a[17]=u=>t.value.publishTime=u),placeholder:"请选择公示时间",clearable:"",type:"datetime"},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"学历",path:"education"},{default:l(()=>[e(o,{value:t.value.education,"onUpdate:value":a[18]||(a[18]=u=>t.value.education=u),placeholder:"输入学历",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"学位",path:"degree"},{default:l(()=>[e(o,{value:t.value.degree,"onUpdate:value":a[19]||(a[19]=u=>t.value.degree=u),placeholder:"输入学位",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n),e(n,null,{default:l(()=>[e(d,{label:"毕业学校",path:"graduation"},{default:l(()=>[e(o,{value:t.value.graduation,"onUpdate:value":a[20]||(a[20]=u=>t.value.graduation=u),placeholder:"输入毕业学校",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"毕业专业",path:"major"},{default:l(()=>[e(o,{value:t.value.major,"onUpdate:value":a[21]||(a[21]=u=>t.value.major=u),placeholder:"输入毕业专业",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"毕业时间",path:"graduateTime"},{default:l(()=>[e(p,{value:t.value.graduateTime,"onUpdate:value":a[22]||(a[22]=u=>t.value.graduateTime=u),placeholder:"请选择毕业时间",clearable:"",type:"date"},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"简介",path:"introduction"},{default:l(()=>[e(o,{value:t.value.introduction,"onUpdate:value":a[23]||(a[23]=u=>t.value.introduction=u),type:"textarea",placeholder:"输入简介",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"其他",path:"description"},{default:l(()=>[e(o,{value:t.value.description,"onUpdate:value":a[24]||(a[24]=u=>t.value.description=u),type:"textarea",placeholder:"输入其他",clearable:""},null,8,["value"])]),_:1})]),_:1}),e(n,null,{default:l(()=>[e(d,{label:"备注",path:"memo"},{default:l(()=>[e(o,{value:t.value.memo,"onUpdate:value":a[25]||(a[25]=u=>t.value.memo=u),type:"textarea",placeholder:"输入备注",clearable:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:l(()=>[k("div",K,[e(x,{"attr-type":"button",onClick:w},{default:l(()=>[_(" 重置 ")]),_:1}),e(x,{loading:b.value,"attr-type":"submit",type:"primary",onClick:O},{default:l(()=>[_(" 添加 ")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])])])}}});const $=G(Q,[["__scopeId","data-v-145211fe"]]);export{$ as default};
